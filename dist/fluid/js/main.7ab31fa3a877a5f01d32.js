!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=8)}([function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return r}));class s{static zero(){return[0,0]}static clone(t){return[...t]}static rotate(t,e){let i=Math.cos(e),s=Math.sin(e);return[t[0]*i-t[1]*s,t[1]*i+t[0]*s]}static dot(t,e){return t[0]*e[0]+t[1]*e[1]}static cross(t,e){return t[0]*e[1]-t[1]*e[0]}static add(t,e){return[t[0]+e[0],t[1]+e[1]]}static sub(t,e){return[t[0]-e[0],t[1]-e[1]]}static mul(t,e){return[t[0]*e[0],t[1]*e[1]]}static div(t,e){return[t[0]/e[0],t[1]/e[1]]}static projection(t,e){var i=s.dot(t,e)/s.dot(e,e);return[e[0]*i,e[1]*i]}static length(t){return Math.sqrt(s.dot(t,t))}static scale(t,e){return[t[0]*e,t[1]*e]}static divScale(t,e){return[t[0]/e,t[1]/e]}static collisionCalc(t,e,i,r){return s.scale(s.add(s.scale(t,i-r),s.scale(e,2*r)),1/(i+r))}static distance(t,e){return s.length(s.sub(t,e))}static normalize(t){const e=s.length(t);return e?s.scale(t,1/e):s.clone(t)}static normal(t){return[-t[1],t[0]]}static negate(t){return[-t[0],-t[1]]}}class r{static set(t,e){return t[0]=e[0],t[1]=e[1],t}static add(t,e){return t[0]+=e[0],t[1]+=e[1],t}static sub(t,e){return t[0]-=e[0],t[1]-=e[1],t}static scale(t,e){return t[0]*=e,t[1]*=e,t}static divScale(t,e){return t[0]/=e,t[1]/=e,t}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return r}));class s{constructor(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s}constains(t){return t[0]>=this.x&&t[0]<=this.x+this.width&&t[1]>=this.y&&t[1]<=this.y+this.height}intersect(t){return!(t.x>this.x+this.width||t.x+t.width<this.x||t.y>this.y+this.height||t.y+t.height<this.y)}get center(){return[this.x+.5*this.width,this.y+.5*this.height]}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}}class r{constructor(t,e=1,i=4,s=5,r=0){this.corner=["northwest","northeast","southeast","southwest"],this.reset(t,e,i,s,r)}reset(t,e=1,i=4,s=5,r=0){this.clear(),this.boundary=t,this.center=[t.x+.5*t.width,t.y+.5*t.height],this.minRange=e,this.maxPoints=i,this.maxLevel=s,this.level=r,this.points=[],this.divided=!1}subdivide(){const t=.5*this.boundary.width,e=.5*this.boundary.height,i=[[0,0],[t,0],[t,e],[0,e]];this.corner.forEach((n,a)=>{this[n]=new r(new s(this.boundary.x+i[a][0],this.boundary.y+i[a][1],t,e),this.minRange,this.maxPoints,this.maxLevel,this.level+1)})}insertOrientation(t){t.point[0]<this.center[0]?t.point[1]<this.center[1]?this.northwest.insert(t):this.southwest.insert(t):t.point[1]<this.center[1]?this.northeast.insert(t):this.southeast.insert(t)}insert(t){if(this.divided)this.insertOrientation(t);else if(this.points.length<this.maxPoints||this.level>this.maxLevel||this.boundary.width<=this.minRange||this.boundary.height<=this.minRange)this.points.push(t);else{this.divided=!0,this.subdivide();for(let t=0;t<this.points.length;t++)this.insertOrientation(this.points[t]);this.points=[],this.insertOrientation(t)}}query(t,e){if(e||(e=[]),!this.boundary.intersect(t))return e;if(this.divided)this.corner.forEach(i=>{this[i].query(t,e)});else for(let i=0;i<this.points.length;i++)t.constains(this.points[i].point)&&e.push(this.points[i]);return e}queryAndMap(t,e){return this.query(t).map(t=>e[t.key])}clear(){this.points=[],this.divided&&(this.corner.forEach(t=>{this[t].clear(),this[t]=void 0}),this.divided=!1)}render(t){t.strokeStyle="#ffffff",t.beginPath(),t.strokeRect(this.boundary.x,this.boundary.y,this.boundary.width,this.boundary.height),t.stroke(),this.divided&&this.corner.forEach(e=>{this[e].render(t)})}}},,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var s=i(0);class r{static resolveCollisionBasic(t,e,i,r,n,a){const o=s.a.sub(e,t);if(s.a.dot(o,a)>0)return;const h=-(1+n)*s.a.dot(o,a)/(i+r);return s.a.scale(a,h)}static intersectCircles(t,e,i,r){const n=s.a.distance(t,i),a=e+r;if(n>=a)return;return{normal:s.a.normalize(s.a.sub(i,t)),depth:a-n}}}},,,,,function(t,e,i){"use strict";i.r(e);var s=i(1),r=i(0);i(3);class n{static mix(t,e,i){return t*(1-i)+e*i}static toRate(t,e,i){return(i-t)/(e-t)}static clamp(t,e,i){return i<=t?t:i>=e?e:i}}class a{constructor(t){this.pos=r.a.clone(t),this.predictedPos=r.a.zero(),this.force=r.a.zero(),this.linearVel=r.a.zero(),this.active=!1,this.radius=2,this.fieldDensity=0,this.propertyForce=[0,0],this.density=1,this.area=this.radius*this.radius*Math.PI,this.mass=this.density*this.area}update(t){r.b.add(this.linearVel,r.a.scale(this.force,t)),r.b.add(this.pos,r.a.scale(this.linearVel,t)),this.force=r.a.zero()}render(t){const e=n.clamp(0,1,n.toRate(0,600,r.a.length(this.linearVel))),i=Math.floor(n.mix(0,360,e));t.fillStyle=`hsl(${i},100%,50%)`,t.beginPath(),t.arc(...this.pos,this.radius,0,2*Math.PI),t.fill()}}const o=document.getElementById("canvas"),h=o.getContext("2d"),c=o.width,l=o.height,u=new s.b(0,0,c,l),d=new s.a(u,10),f=[],p=[0,9.81*10],y=Math.ceil(20);for(let t=0;t<400;t++){const e=t%20,i=Math.floor(t/20);f.push(new a([.5*c+8*(e-10+.5),.5*l+8*(i-.5*y+.5)]))}o.addEventListener("click",t=>{r.b.set(b,[t.offsetX,t.offsetY]);const e=Math.ceil(10);for(let t=0;t<100;t++){const i=t%10,s=Math.floor(t/10);f.push(new a([b[0]+10*(i-5+.5),b[1]+10*(s-.5*e+.5)]))}});const b=[0,0];o.addEventListener("mousemove",t=>{r.b.set(b,[t.offsetX,t.offsetY])});const g=(t,e,i)=>{let s=0;return e.forEach(e=>{const n=r.a.distance(e.pos,t),a=((t,e)=>{if(e>=t)return 0;return(t-e)**2/(Math.PI*t**4/6)})(i,n);s+=1*a}),s},m=t=>40*(t-.012),v=(t,e,i)=>{const s=r.a.zero(),n=i*i*Math.PI;return e.forEach(e=>{if(e===t)return;const a=r.a.sub(e.pos,t.pos),o=r.a.length(a);if(!o)return;const h=0==o?(()=>{const t=2*Math.random()*Math.PI;return[Math.cos(t),Math.sin(t)]})():r.a.divScale(a,o),c=((t,e)=>{if(t>=e)return 0;return 12/(Math.PI*e**4)*(t-e)})(o,i);let l=e.fieldDensity;if(!l)return;const u=.5*(m(l)+m(t.fieldDensity));r.b.add(s,r.a.scale(h,u*c*n/l))}),s};let x=Date.now();const w=()=>{requestAnimationFrame(w);const t=Date.now(),e=(t-x)/1e3;x=t,(t=>{h.fillStyle="#000000",h.fillRect(0,0,c,l),d.clear(),f.forEach((t,e)=>{t.active=!1,d.insert({key:e,point:t.pos})});const e=f.map((t,e)=>{const i=new s.b(t.pos[0]-30,t.pos[1]-30,60,60);return d.query(i).filter(e=>r.a.distance(f[e.key].pos,t.pos)<=30).map(t=>f[t.key])});f.forEach(e=>{r.b.add(e.linearVel,r.a.scale(p,t)),r.b.set(e.predictedPos,r.a.add(e.pos,r.a.scale(e.linearVel,t)))}),e.forEach((t,e)=>{f[e].fieldDensity=g(f[e].predictedPos,t,30)}),e.forEach((e,i)=>{const s=f[i];r.b.scale(s.linearVel,.99);const n=v(s,e,30),a=r.a.divScale(n,s.fieldDensity);r.b.add(s.linearVel,r.a.scale(a,t))}),f.forEach(e=>{r.b.add(e.pos,r.a.scale(e.linearVel,t))}),f.forEach(t=>((t,e,i)=>{t.pos[0]<e.left+t.radius?(t.pos[0]=e.left+t.radius,t.linearVel[0]*=-1*i):t.pos[0]>e.right-t.radius&&(t.pos[0]=e.right-t.radius,t.linearVel[0]*=-1*i),t.pos[1]<e.top+t.radius?(t.pos[1]=e.top+t.radius,t.linearVel[1]*=-1*i):t.pos[1]>e.bottom-t.radius&&(t.pos[1]=e.bottom-t.radius,t.linearVel[1]*=-1*i)})(t,u,1)),f.forEach(t=>t.render(h)),h.strokeStyle="#ff0000",h.beginPath(),h.arc(...b,30,0,2*Math.PI),h.stroke()})(.02),h.font="18px Noto Sans TC",h.textAlign="start",h.textBaseline="hanging",h.fillStyle="#ffffff",h.fillText((1/e).toFixed(1),10,10)};requestAnimationFrame(w)}]);